<div class="cards-view-page">
  <div class="page-header">
    <div>
      <h1>عرض البطاقات</h1>
      <p>عرض الحوادث في شكل بطاقات</p>
    </div>
  </div>

  <div class="filters-section">
    <div class="search-box">
      <input
        type="text"
        [(ngModel)]="searchTerm"
        (ngModelChange)="applyFilters()"
        placeholder="بحث..."
        class="search-input"
      />
      <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="11" cy="11" r="8"/>
        <path d="M21 21l-4.35-4.35"/>
      </svg>
    </div>

    <div class="filter-controls">
      <select [(ngModel)]="statusFilter" (ngModelChange)="applyFilters()" class="filter-select">
        <option value="all">جميع الحالات</option>
        <option value="pending">قيد المراجعة</option>
        <option value="investigating">قيد التحقيق</option>
        <option value="resolved">تم الحل</option>
        <option value="rejected">مرفوض</option>
      </select>

      <select [(ngModel)]="categoryFilter" (ngModelChange)="applyFilters()" class="filter-select">
        <option value="all">جميع الفئات</option>
        <option *ngFor="let cat of categories" [value]="cat">{{ cat }}</option>
      </select>
    </div>
  </div>

  <div class="cards-grid" *ngIf="!loading">
    <app-unified-card
      *ngFor="let violation of getPaginatedViolations()"
      [title]="violation.title"
      [subtitle]="violation.description"
      [badge]="getStatusLabel(violation.status)"
      [badgeColor]="getStatusColor(violation.status)"
      [clickable]="true"
      (cardClick)="onCardClick(violation)"
    >
      <div class="card-details">
        <div class="detail-item">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
            <path d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
          </svg>
          <span>{{ violation.location }}</span>
        </div>
        <div class="detail-item">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"/>
          </svg>
          <span>{{ violation.category }}</span>
        </div>
        <div class="detail-item">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
          </svg>
          <span>{{ violation.reportedDate | date:'short' }}</span>
        </div>
      </div>
    </app-unified-card>
  </div>

  <div class="loading-state" *ngIf="loading">
    <div class="loading-spinner">
      <span></span>
      <span></span>
      <span></span>
    </div>
    <p>جاري التحميل...</p>
  </div>

  <div class="empty-state" *ngIf="!loading && filteredViolations.length === 0">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <circle cx="12" cy="12" r="10"/>
      <line x1="12" y1="8" x2="12" y2="12"/>
      <line x1="12" y1="16" x2="12.01" y2="16"/>
    </svg>
    <p>لا توجد حوادث</p>
  </div>

  <div class="pagination" *ngIf="!loading && totalPages > 1">
    <button
      type="button"
      class="page-btn"
      [disabled]="currentPage === 1"
      (click)="goToPage(currentPage - 1)"
    >
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="15 18 9 12 15 6"/>
      </svg>
      السابق
    </button>
    <div class="page-info">
      صفحة {{ currentPage }} من {{ totalPages }}
    </div>
    <button
      type="button"
      class="page-btn"
      [disabled]="currentPage === totalPages"
      (click)="goToPage(currentPage + 1)"
    >
      التالي
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="9 18 15 12 9 6"/>
      </svg>
    </button>
  </div>
</div>
