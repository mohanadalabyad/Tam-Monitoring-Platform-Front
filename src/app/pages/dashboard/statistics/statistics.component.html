<div class="statistics-page">
  <div class="page-header">
    <h1>الإحصائيات</h1>
    <p>نظرة عامة على النظام</p>
  </div>

  <div class="stats-grid" *ngIf="!loading">
    <div class="stat-card">
      <div class="stat-icon stat-icon-primary">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
        </svg>
      </div>
      <div class="stat-content">
        <div class="stat-value">{{ totalViolations }}</div>
        <div class="stat-label">إجمالي الحوادث</div>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon stat-icon-warning">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"/>
          <line x1="12" y1="8" x2="12" y2="12"/>
          <line x1="12" y1="16" x2="12.01" y2="16"/>
        </svg>
      </div>
      <div class="stat-content">
        <div class="stat-value">{{ pendingViolations }}</div>
        <div class="stat-label">قيد المراجعة</div>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon stat-icon-success">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
          <polyline points="22 4 12 14.01 9 11.01"/>
        </svg>
      </div>
      <div class="stat-content">
        <div class="stat-value">{{ resolvedViolations }}</div>
        <div class="stat-label">تم الحل</div>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon stat-icon-info">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/>
          <circle cx="9" cy="7" r="4"/>
          <path d="M23 21v-2a4 4 0 00-3-3.87"/>
          <path d="M16 3.13a4 4 0 010 7.75"/>
        </svg>
      </div>
      <div class="stat-content">
        <div class="stat-value">{{ totalUsers }}</div>
        <div class="stat-label">إجمالي المستخدمين</div>
      </div>
    </div>
  </div>

  <div class="recent-activity card" *ngIf="!loading">
    <h2>الحوادث الأخيرة</h2>
    <div class="activity-list">
      <div
        *ngFor="let violation of recentViolations"
        class="activity-item"
      >
        <div class="activity-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
          </svg>
        </div>
        <div class="activity-content">
          <div class="activity-title">حادثة #{{ violation.id }}</div>
          <div class="activity-meta">
            <span class="badge" [ngClass]="'badge-' + getStatusLabel(violation.acceptanceStatus).toLowerCase()">
              {{ getStatusLabel(violation.acceptanceStatus) }}
            </span>
            <span class="activity-date">{{ violation.violationDate | date:'short' }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="loading-state" *ngIf="loading">
    <div class="spinner"></div>
    <p>جاري تحميل الإحصائيات...</p>
  </div>
</div>
