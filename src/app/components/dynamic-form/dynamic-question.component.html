<div class="dynamic-question" [class.required]="question.isRequired" [class.invalid]="isInvalid()">
  <label class="question-label">
    {{ question.text }}
    <span class="required-indicator" *ngIf="question.isRequired">*</span>
  </label>

  <!-- Text Input (Type 1) -->
  <input
    *ngIf="question.questionType === QuestionType.Text"
    type="text"
    [value]="value || ''"
    (input)="onValueChange($any($event.target).value)"
    [placeholder]="question.text"
    class="text-input"
  />

  <!-- Yes/No (Type 2) -->
  <div *ngIf="question.questionType === QuestionType.YesNo" class="yesno-group">
    <label class="yesno-option">
      <input
        type="radio"
        [name]="'yesno-' + question.id"
        value="نعم"
        [checked]="value === 'نعم'"
        (change)="onValueChange('نعم')"
      />
      <span>نعم</span>
    </label>
    <label class="yesno-option">
      <input
        type="radio"
        [name]="'yesno-' + question.id"
        value="لا"
        [checked]="value === 'لا'"
        (change)="onValueChange('لا')"
      />
      <span>لا</span>
    </label>
  </div>

  <!-- Rating (Type 3) - 1-5 scale -->
  <div *ngIf="question.questionType === QuestionType.Rating" class="rating-group">
    <div class="rating-options">
      <label *ngFor="let i of [1,2,3,4,5]" class="rating-option">
        <input
          type="radio"
          [name]="'rating-' + question.id"
          [value]="i"
          [checked]="value === toString(i)"
          (change)="onValueChange(toString(i))"
        />
        <span class="rating-number">{{ i }}</span>
      </label>
    </div>
    <div class="rating-labels">
      <span>منخفض</span>
      <span>عالٍ</span>
    </div>
  </div>

  <!-- MultipleChoice (Type 4) - Conditional rendering based on hasMultiSelect -->
  <!-- Single Selection (Radio Buttons) -->
  <div *ngIf="question.questionType === QuestionType.MultipleChoice && !question.hasMultiSelect" class="single-choice-group">
    <div class="radio-option-list">
      <label *ngFor="let option of getOptions(); trackBy: trackByOption" class="radio-option">
        <input
          type="radio"
          [name]="'mc-single-' + question.id"
          [value]="option"
          [checked]="isSingleOptionSelected(option)"
          (change)="onSingleChoiceChange(option)"
        />
        <span>{{ option }}</span>
      </label>
    </div>
    
    <!-- Other Option -->
    <div *ngIf="question.hasOtherOption" class="single-other-option-group">
      <label class="radio-option">
        <input
          type="radio"
          [name]="'mc-single-' + question.id"
          value="__OTHER__"
          [checked]="otherOptionSelected"
          (change)="onSingleOtherOptionChange(true)"
        />
        <span>{{ question.otherOptionText || 'أخرى' }}</span>
      </label>
      <input
        *ngIf="otherOptionSelected"
        type="text"
        [value]="otherOptionText"
        (input)="onSingleOtherTextChange($any($event.target).value)"
        [placeholder]="'أدخل ' + (question.otherOptionText || 'أخرى')"
        class="other-option-input"
      />
    </div>
  </div>

  <!-- Multiple Selection (Checkboxes) -->
  <div *ngIf="question.questionType === QuestionType.MultipleChoice && question.hasMultiSelect" class="multiple-choice-group">
    <div class="options-checkbox-list">
      <label *ngFor="let option of getOptions(); trackBy: trackByOption" class="checkbox-option">
        <input
          type="checkbox"
          [checked]="isOptionSelected(option)"
          (change)="toggleOption(option)"
        />
        <span>{{ option }}</span>
      </label>
    </div>

    <!-- Other Option -->
    <div *ngIf="question.hasOtherOption" class="other-option-group">
      <label class="checkbox-option">
        <input
          type="checkbox"
          [checked]="otherOptionSelected"
          (change)="onOtherOptionChange($any($event.target).checked)"
        />
        <span>{{ question.otherOptionText || 'أخرى' }}</span>
      </label>
      <input
        *ngIf="otherOptionSelected"
        type="text"
        [value]="otherOptionText"
        (input)="onOtherTextChange($any($event.target).value)"
        [placeholder]="'أدخل ' + (question.otherOptionText || 'أخرى')"
        class="other-option-input"
      />
    </div>
  </div>

  <!-- Date (Type 5) -->
  <input
    *ngIf="question.questionType === QuestionType.Date"
    type="date"
    [value]="value || ''"
    (input)="onValueChange($any($event.target).value)"
    class="date-input"
  />

  <!-- Number (Type 6) -->
  <input
    *ngIf="question.questionType === QuestionType.Number"
    type="number"
    [value]="value || ''"
    (input)="onValueChange($any($event.target).value)"
    class="number-input"
  />

  <div class="error-message" *ngIf="isInvalid()">
    {{ getErrorMessage() }}
  </div>
</div>
