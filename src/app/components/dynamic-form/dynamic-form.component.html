<div class="dynamic-form" *ngIf="!loading">
  <form [formGroup]="formGroup" (ngSubmit)="onSubmit()">
    <div *ngIf="sections.length > 0">
      <div *ngFor="let section of sections" class="form-section">
        <h3 class="section-title">{{ section }}</h3>
        <div class="questions-container">
          <div *ngFor="let question of getQuestionsBySection(section)" class="question-wrapper">
            <app-dynamic-question
              *ngIf="shouldShowQuestion(question)"
              [question]="question"
              [formControlName]="question.id"
            ></app-dynamic-question>
          </div>
        </div>
      </div>
    </div>

    <div class="form-section" *ngIf="getQuestionsBySection().length > 0">
      <div class="questions-container">
        <div *ngFor="let question of getQuestionsBySection()" class="question-wrapper">
            <app-dynamic-question
              *ngIf="shouldShowQuestion(question)"
              [question]="question"
              [formControlName]="question.id"
            ></app-dynamic-question>
        </div>
      </div>
    </div>
  </form>
</div>

<div class="loading-state" *ngIf="loading">
  <div class="spinner"></div>
  <p>جاري تحميل النموذج...</p>
</div>

<div class="empty-state" *ngIf="!loading && questions.length === 0">
  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
    <circle cx="12" cy="12" r="10"/>
    <line x1="12" y1="8" x2="12" y2="12"/>
    <line x1="12" y1="16" x2="12.01" y2="16"/>
  </svg>
  <p>لا توجد أسئلة متاحة لهذا النموذج.</p>
</div>
